# Place all functions below
function r_l_test { ./node_modules/.bin/jest -u __tests__/roleLibrary/$1; }

function rebase_branch {
   git reset HEAD~;
   git clean -fd;
   git stash push -m "$(date)"
   git checkout $1;
   git pull origin $1

}

# GIT FUNCTIONS

function gs { git status; }

function base_project_path { cd ~/vscode; }

function base_react_path { cd ~/vscode/www/react; }

function gcm {
   git commit -m "$1"
}

function gush {
   branch=$(git rev-parse --abbrev-ref HEAD)
   echo "push origin $branch"
   git push origin $branch
}

function ga_pro {
   CYAN='\033[0;36m'
   NC='\033[0m' # No Color
   i=0
   while read line ; do 
      i=$(( i + 1 ))
      echo "$i) $line"
   done < <(git ls-files -m)

   
   while true; do
      read -p "Select (multi comma separated)? " vals
      IFS=',' read -r -a array <<< "$vals"
      files=()
      for num in  "${array[@]}"; do
         file=$(git_pos $num)
         files+=($file)
      done
      for f in "${files[@]}"; do
         ga $f
      done
      break;
   done
}

function ga {
   ORANGE='\033[0;33m'
   GREEN='\033[0;32m'
   NC='\033[0m' # No Color
   local file="$1"
   if [[ $1 =~ ^-?[0-9]+$ ]]; then
      file=$(git_pos $1)
   fi
   base_project_path
   if [[ $file == *.js ]]; then
      echo -e "${ORANGE}ES Linting: $file${NC}"
      base_react_path
      ./node_modules/.bin/eslint --fix --color $file
   fi

   if [[ $file == *.py ]]; then
      echo -e "${ORANGE}Py Linting: $file${NC}"
      py2lint $file | tee /tmp/py2lint.out 2> /dev/null
   fi
   base_project_path
   echo -e "${GREEN}git add $file${NC}"
   git add $file
}

function gd {
   local file="$1"
   if [[ $1 =~ ^-?[0-9]+$ ]]; then
      file=$(git_pos $1)
   fi
   git diff $file
}

function git_pos {
   regex="modified:[ ]*(.*?)"
   i=0
   git ls-files -m | while read line ;
   do 
      i=$(( i + 1 ))
      if [ $i == $1 ]; then
         echo $line
         return 1         
      fi
   done 
}

function ga_z {
   local file="$1"
   if [[ $1 =~ ^-?[0-9]+$ ]]; then
      file=$(git_pos $1)
   fi
   echo -e "${GREEN}git add $file${NC}"
   git add $file
}